C51 COMPILER V9.55   AD                                                                    09/28/2019 19:10:37 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE AD
OBJECT MODULE PLACED IN .\Objects\AD.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\SYSTEM\AD.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\SYSTEM;..\HARDWARE;..\
                    -USER) DEBUG OBJECTEXTEND PRINT(.\Listings\AD.lst) TABS(2) OBJECT(.\Objects\AD.obj)

line level    source

   1          #include  <STC8.h>
   2          #include  "AD.h"
   3          #include <myself.h>
   4          #include  "Serial.h"
   5          bit bFlagAD=0;
   6          unsigned char cADCResult=0;
   7          
   8          bit bFlagReflashFDC2214=0;//ÓÃÓÚÏÔÊ¾ÆÁÍ¨µÀÖµÏÔÊ¾Ë¢ÐÂÔÊÐí£¬ÔÚADÖÐ¶ÏÖÐ£¬
   9          //Ö»Òª²âµ½ÓÐ°´¼ü£¬¾ÍÍ¨¹ý±¾±êÖ¾Í£Ö¹Ë¢ÐÂÏÔÊ¾FDC2214Í¨µÀÖµ
  10          //½â¾öÁËÔÚÏÔÊ¾FDC2214¸÷Í¨µÀÖµÊ±£¬ÐèÒª³¤Ê±¼ä°´ÏòÓÒ¼üÇÐ»»²Ëµ¥µÄÎÊÌâ
  11          
  12          void ADCInit()
  13          {
  14   1      
  15   1          P1M0 = 0x00;                                //ÉèÖÃP1.0ÎªADC¿Ú
  16   1          P1M1 = 0x01;
  17   1          ADCCFG = 0x0f;                              //½á¹û×ó¶ÔÆë£¬ÉèÖÃADCÊ±ÖÓÎªÏµÍ³Ê±ÖÓ/2/16/16
  18   1        
  19   1        
  20   1          ADC_CONTR = ADC_POWER |  0x03;  //Ñ¡ÔñP1.3Í¨µÀ
  21   1          EADC = 1;                                   //Ê¹ÄÜADCÖÐ¶Ï
  22   1        //IE = IE | 0xa0 ;                      //Ê¹ÄÜADCÖÐ¶Ï
  23   1          EA = 1;
  24   1          ADC_CONTR |= ADC_START;                          //Æô¶¯AD×ª»» 
  25   1          DelayNms24MHz(2);//ADCÉÏµç²¢ÑÓÊ±
  26   1          
  27   1      
  28   1          
  29   1      }
  30          
  31          void adc_isr() interrupt 5 using 3//AD ÖÐ¶Ï´¦Àíº¯Êý
  32          {
  33   1          extern unsigned char code KeyThreshold[7];
  34   1          ADC_CONTR &= ~ADC_FLAG;                         //ÇåÖÐ¶Ï±êÖ¾
  35   1          cADCResult = ADC_RES;                        //¶ÁÈ¡ADC½á¹û
  36   1          bFlagAD=1;
  37   1      //    ADC_CONTR |= ADC_START;                          //¼ÌÐøAD×ª»»  //ÔÚ2ms¶¨Ê±ÖÐ¶ÏÖÐ¿ªÆôADC
  38   1        
  39   1      
  40   1          bFlagReflashFDC2214=(cADCResult< KeyThreshold[5])?0:1;//Ë¢ÐÂ±êÖ¾£¬Ö÷³ÌÐòÖÐ£¬Ö»ÓÐ°´¼üÌ§ÆðÀ´£¬²Å¿ÉÒÔË¢ÐÂµ
             -Ú1Ò³¸÷Í¨µÀÈÊÕþ  
  41   1      //  cADCResult< KeyThreshold[5]ÊÇÓÐ°´¼ü°´ÏÂµÄÇé¿ö 
  42   1      }
  43          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     71    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
C51 COMPILER V9.55   AD                                                                    09/28/2019 19:10:37 PAGE 2   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
