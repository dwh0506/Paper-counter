C51 COMPILER V9.55   AD                                                                    10/28/2019 08:35:36 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE AD
OBJECT MODULE PLACED IN .\Objects\AD.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\SYSTEM\AD.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\SYSTEM;..\HARDWARE;..\
                    -USER) DEBUG OBJECTEXTEND PRINT(.\Listings\AD.lst) TABS(2) OBJECT(.\Objects\AD.obj)

line level    source

   1          #include  <STC15F2K60S2.h>
   2          #include  "AD.h"
   3          #include <myself.h>
   4          #include  "Serial.h"
   5          bit bFlagAD=0;
   6          unsigned char cADCResult=0;
   7          
   8          bit bFlagReflashFDC2214=0;//ÓÃÓÚÏÔÊ¾ÆÁÍ¨µÀÖµÏÔÊ¾Ë¢ÐÂÔÊÐí£¬ÔÚADÖÐ¶ÏÖÐ£¬
   9          //Ö»Òª²âµ½ÓÐ°´¼ü£¬¾ÍÍ¨¹ý±¾±êÖ¾Í£Ö¹Ë¢ÐÂÏÔÊ¾FDC2214Í¨µÀÖµ
  10          //½â¾öÁËÔÚÏÔÊ¾FDC2214¸÷Í¨µÀÖµÊ±£¬ÐèÒª³¤Ê±¼ä°´ÏòÓÒ¼üÇÐ»»²Ëµ¥µÄÎÊÌâ
  11          
  12          void ADCInit()
  13          {
  14   1      
  15   1          P1ASF = 0x08;                   //ÉèÖÃP13¿ÚÎªAD¿Ú
  16   1          ADC_RES = 0;                    //Çå³ý½á¹û¼Ä´æÆ÷
  17   1          ADC_CONTR = ADC_POWER | ADC_SPEEDHH | ADC_START | 0x03;//¸ÄÎª×î¸ßËÙ¶È
  18   1          //IE = IE | 0xa0 ;                      //Ê¹ÄÜADCÖÐ¶Ï
  19   1          
  20   1          EADC = 1;    //Ê¹ÄÜADCÖÐ¶Ï
  21   1          DelayNms(2);//ADCÉÏµç²¢ÑÓÊ±
  22   1          
  23   1      
  24   1          
  25   1      }
  26          
  27          void adc_isr() interrupt 5 using 3//AD ÖÐ¶Ï´¦Àíº¯Êý
  28          {
  29   1          extern unsigned char code KeyThreshold[7];
  30   1          ADC_CONTR &= ~ADC_FLAG;                         //ÇåÖÐ¶Ï±êÖ¾
  31   1          cADCResult = ADC_RES;                        //¶ÁÈ¡ADC½á¹û
  32   1          bFlagAD=1;
  33   1      //    ADC_CONTR |= ADC_START;                          //¼ÌÐøAD×ª»»  //ÔÚ2ms¶¨Ê±ÖÐ¶ÏÖÐ¿ªÆôADC
  34   1        
  35   1      
  36   1          bFlagReflashFDC2214=(cADCResult< KeyThreshold[5])?0:1;//Ë¢ÐÂ±êÖ¾£¬Ö÷³ÌÐòÖÐ£¬Ö»ÓÐ°´¼üÌ§ÆðÀ´£¬²Å¿ÉÒÔË¢ÐÂµ
             -Ú1Ò³¸÷Í¨µÀÈÊÕþ  
  37   1      //  cADCResult< KeyThreshold[5]ÊÇÓÐ°´¼ü°´ÏÂµÄÇé¿ö 
  38   1      }
  39          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     63    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
